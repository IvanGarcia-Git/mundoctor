import{e as A,r as j,u as D,j as e,ak as L,v as E,I,g as P,al as M,am as X,a8 as B,E as H,C as w,c as C,a7 as S,ab as q,ac as G,B as R,an as V,ao as O,ap as $,o as W,a as U,b as z,q as T,aq as J,R as K,aa as Q,ar as Y}from"./index-2d2343af.js";import{T as Z,a as _,b as f,c as b}from"./tabs-a9bb6abf.js";import{S as ee}from"./save-12bebf84.js";const ae=A("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),se=A("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),re=A("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),te=({currentAvatarUrl:t,userName:N,onAvatarUpdate:a,size:g="xl",className:i=""})=>{const[p,v]=j.useState(!1),[h,r]=j.useState(null),[y,s]=j.useState(null),{toast:l}=D(),o=c=>{const n=c.target.files[0];if(!n)return;if(!n.type.startsWith("image/")){l({title:"Error",description:"Solo se permiten archivos de imagen",variant:"destructive"});return}if(n.size>2*1024*1024){l({title:"Error",description:"El archivo debe ser menor a 2MB",variant:"destructive"});return}r(n);const m=new FileReader;m.onload=x=>{s(x.target.result)},m.readAsDataURL(n)},d=async()=>{var c,n;if(h){v(!0);try{const m=new FormData;m.append("avatar",h);const x=await((n=(c=window.Clerk)==null?void 0:c.session)==null?void 0:n.getToken());if(!x)throw new Error("No se pudo obtener el token de autenticación");const k=await(await fetch("http://localhost:8000/api/uploads/avatar",{method:"POST",headers:{Authorization:`Bearer ${x}`,"clerk-db-jwt":x},body:m})).json();if(k.success){l({title:"Éxito",description:"Avatar actualizado correctamente",variant:"default"}),a&&a(k.data.url),r(null),s(null);const F=document.getElementById("avatar-upload");F&&(F.value="")}else throw new Error(k.message||"Error al subir el avatar")}catch(m){l({title:"Error",description:m.message||"Error al subir el avatar",variant:"destructive"})}finally{v(!1)}}},u=()=>{r(null),s(null);const c=document.getElementById("avatar-upload");c&&(c.value="")};return e.jsxs("div",{className:`flex flex-col items-center space-y-4 ${i}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{imageUrl:y||t,name:N,size:g,className:"border-2 border-border"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer",children:e.jsx(re,{className:"w-8 h-8 text-white"})})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(E,{htmlFor:"avatar-upload",className:"text-sm font-medium",children:"Foto de perfil"}),e.jsx(I,{id:"avatar-upload",type:"file",accept:"image/*",onChange:o,className:"w-full max-w-xs"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"JPG, PNG hasta 2MB"})]}),h&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(P,{onClick:d,disabled:p,size:"sm",className:"bg-primary hover:bg-primary/90",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Subiendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Confirmar"]})}),e.jsxs(P,{onClick:u,disabled:p,variant:"outline",size:"sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Cancelar"]})]})]})},de=()=>{const{user:t}=B(),{toast:N}=D(),[a,g]=j.useState({fullName:(t==null?void 0:t.name)||"Dr. Ejemplo Por Defecto",email:(t==null?void 0:t.email)||"ejemplo@example.com",phone:"600123456",specialty:"Cardiología",licenseNumber:"2828XXXXX",bio:"Especialista con más de 10 años de experiencia en el diagnóstico y tratamiento de enfermedades cardiovasculares. Comprometido con el bienestar del paciente.",services:"Consulta, ECG, Ecocardiograma, Prueba de esfuerzo",officeAddress:"Calle Falsa 123, Consultorio 5, Madrid",officeHours:"L-V: 9:00-14:00, 16:00-20:00",website:"https://www.drejemplo.com",languages:"Español, Inglés",profileImage:(t==null?void 0:t.avatarUrl)||"",bannerImage:""}),i=s=>{const{name:l,value:o}=s.target;g(d=>({...d,[l]:o}))},p=(s,l)=>{if(s.target.files&&s.target.files[0]){const o=new FileReader;o.onload=d=>{g(u=>({...u,[l]:d.target.result}))},o.readAsDataURL(s.target.files[0])}},v=s=>{g(l=>({...l,profileImage:s}))},h=s=>{s.preventDefault(),console.log("Perfil guardado:",a),N({title:"Perfil Actualizado",description:"Tu información de perfil público ha sido guardada con éxito."})},r=({id:s,label:l,icon:o,type:d="text",value:u,onChange:c,placeholder:n,name:m,...x})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(E,{htmlFor:s,className:"text-foreground dark:text-gray-300 flex items-center",children:[K.cloneElement(o,{size:16,className:"mr-2 text-muted-foreground dark:text-gray-400"}),l]}),d==="textarea"?e.jsx(Q,{id:s,name:m||s,placeholder:n,value:u,onChange:c,rows:4,className:"bg-input dark:bg-slate-700 border-border dark:border-gray-600 text-foreground dark:text-white placeholder:text-muted-foreground dark:placeholder:text-gray-500",...x}):e.jsx(I,{id:s,name:m||s,type:d,placeholder:n,value:u,onChange:c,className:"bg-input dark:bg-slate-700 border-border dark:border-gray-600 text-foreground dark:text-white placeholder:text-muted-foreground dark:placeholder:text-gray-500",...x})]}),y=({id:s,label:l,currentImage:o,onChange:d})=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(E,{htmlFor:s,className:"text-foreground dark:text-gray-300 flex items-center",children:[e.jsx(Y,{size:16,className:"mr-2 text-muted-foreground dark:text-gray-400"}),l]}),e.jsxs("div",{className:"flex items-center gap-4",children:[o&&e.jsx("img-replace",{src:o,alt:"Previsualización",className:"w-20 h-20 rounded-md object-cover border dark:border-gray-600"}),e.jsx(I,{id:s,type:"file",accept:"image/*",onChange:u=>d(u,s),className:"bg-input dark:bg-slate-700 border-border dark:border-gray-600 text-foreground dark:text-white file:text-primary file:font-medium file:mr-2"})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground dark:text-white",children:"Editar Perfil Público"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Mantén tu información actualizada para tus pacientes."})]}),e.jsxs("form",{onSubmit:h,children:[e.jsxs(Z,{defaultValue:"personal",className:"w-full",children:[e.jsxs(_,{className:"grid w-full grid-cols-2 md:grid-cols-5 mb-6 bg-muted dark:bg-slate-800 text-muted-foreground dark:text-gray-400",children:[e.jsx(f,{value:"personal",className:"data-[state=active]:bg-background dark:data-[state=active]:bg-slate-700 data-[state=active]:text-foreground dark:data-[state=active]:text-white",children:"Info Personal"}),e.jsx(f,{value:"professional",className:"data-[state=active]:bg-background dark:data-[state=active]:bg-slate-700 data-[state=active]:text-foreground dark:data-[state=active]:text-white",children:"Info Profesional"}),e.jsx(f,{value:"contact",className:"data-[state=active]:bg-background dark:data-[state=active]:bg-slate-700 data-[state=active]:text-foreground dark:data-[state=active]:text-white",children:"Contacto y Horarios"}),e.jsx(f,{value:"media",className:"data-[state=active]:bg-background dark:data-[state=active]:bg-slate-700 data-[state=active]:text-foreground dark:data-[state=active]:text-white",children:"Multimedia"}),e.jsxs(f,{value:"preview",className:"data-[state=active]:bg-background dark:data-[state=active]:bg-slate-700 data-[state=active]:text-foreground dark:data-[state=active]:text-white flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"Vista Previa"]})]}),e.jsx(w,{className:"bg-card dark:bg-gray-800/60 border-border dark:border-gray-700/50 shadow-lg",children:e.jsxs(C,{className:"pt-6",children:[e.jsx(b,{value:"personal",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(r,{id:"fullName",name:"fullName",label:"Nombre Completo",icon:e.jsx(S,{}),value:a.fullName,onChange:i,placeholder:"Tu nombre completo"}),e.jsx(r,{id:"email",name:"email",label:"Email Público",icon:e.jsx(q,{}),type:"email",value:a.email,onChange:i,placeholder:"tu@email.com",disabled:!0}),e.jsx(r,{id:"phone",name:"phone",label:"Teléfono Público",icon:e.jsx(G,{}),type:"tel",value:a.phone,onChange:i,placeholder:"Ej: +34 600123456"}),e.jsx(r,{id:"languages",name:"languages",label:"Idiomas Hablados",icon:e.jsx(ae,{}),value:a.languages,onChange:i,placeholder:"Español, Inglés, Francés..."})]})}),e.jsxs(b,{value:"professional",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(r,{id:"specialty",name:"specialty",label:"Especialidad Principal",icon:e.jsx(R,{}),value:a.specialty,onChange:i,placeholder:"Ej: Cardiología"}),e.jsx(r,{id:"licenseNumber",name:"licenseNumber",label:"Número de Colegiado",icon:e.jsx(V,{}),value:a.licenseNumber,onChange:i,placeholder:"Ej: 2828XXXXX"})]}),e.jsx("div",{className:"mt-6",children:e.jsx(r,{id:"bio",name:"bio",label:"Biografía / Sobre mí",icon:e.jsx(S,{}),type:"textarea",value:a.bio,onChange:i,placeholder:"Comparte tu experiencia y enfoque profesional..."})}),e.jsx("div",{className:"mt-6",children:e.jsx(r,{id:"services",name:"services",label:"Servicios Ofrecidos",icon:e.jsx(O,{}),type:"textarea",value:a.services,onChange:i,placeholder:"Listado de servicios, separados por comas. Ej: Consulta, ECG, Pruebas..."})})]}),e.jsx(b,{value:"contact",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(r,{id:"officeAddress",name:"officeAddress",label:"Dirección de la Consulta",icon:e.jsx($,{}),value:a.officeAddress,onChange:i,placeholder:"Calle, Número, Ciudad"}),e.jsx(r,{id:"officeHours",name:"officeHours",label:"Horario de Atención",icon:e.jsx(W,{}),value:a.officeHours,onChange:i,placeholder:"Ej: L-V 9:00-18:00"}),e.jsx(r,{id:"website",name:"website",label:"Página Web (Opcional)",icon:e.jsx(se,{}),type:"url",value:a.website,onChange:i,placeholder:"https://tuweb.com"})]})}),e.jsx(b,{value:"media",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsxs(U,{children:[e.jsx(z,{className:"text-lg",children:"Foto de Perfil"}),e.jsx(T,{children:"Esta imagen aparecerá en tu perfil público y en los resultados de búsqueda"})]}),e.jsx(C,{children:e.jsx(te,{currentAvatarUrl:a.profileImage,userName:a.fullName,onAvatarUpdate:v,size:"xl",className:"w-full"})})]}),e.jsxs(w,{children:[e.jsxs(U,{children:[e.jsx(z,{className:"text-lg",children:"Imagen de Cabecera"}),e.jsx(T,{children:"Imagen opcional para personalizar tu perfil"})]}),e.jsx(C,{children:e.jsx(y,{id:"bannerImage",label:"Imagen de Cabecera (Opcional)",currentImage:a.bannerImage,onChange:p})})]})]})}),e.jsx(b,{value:"preview",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Vista Previa del Perfil"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:'Así es como los pacientes verán tu perfil público. Las aseguradoras mostradas provienen de tu configuración en la pestaña "Aseguradoras" de Configuración.'})]}),e.jsx(J,{professional:{...a,name:a.fullName,image:a.profileImage||"https://via.placeholder.com/150",imageAlt:`${a.fullName} - ${a.specialty}`,city:a.officeAddress,rating:4.8,reviews:0,licenseNumber:a.licenseNumber,contact:{phone:a.phone,email:a.email},services:a.services.split(",").map(s=>s.trim()).filter(s=>s.length>0),education:["Información de formación desde la configuración"],experience:["Información de experiencia desde la configuración"],opinions:[],insurance:(t==null?void 0:t.insuranceData)||{worksWithInsurance:!1,insuranceCompanies:[]}}})]})})]})})]}),e.jsx("div",{className:"mt-8 flex justify-end",children:e.jsxs(P,{type:"submit",className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:[e.jsx(ee,{size:18,className:"mr-2"})," Guardar Cambios"]})})]})]})};export{de as default};
