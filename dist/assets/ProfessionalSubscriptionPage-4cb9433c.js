import{a8 as R,u as V,r as c,aI as C,j as e,v as y,i as N,C as m,a as k,b as v,q as w,c as P,p as $,g as o,aJ as K,L as Q}from"./index-2d2343af.js";import{D,f as W,a as S,b as F,c as O,d as B,e as E,g as A}from"./dialog-fc1c39cc.js";import{S as X}from"./switch-be1f715e.js";const ee=()=>{const{user:x}=R(),{toast:g}=V(),[h,p]=c.useState((x==null?void 0:x.subscriptionPlanId)||"basic"),[T,b]=c.useState(!1),[q,u]=c.useState(!1),[i,j]=c.useState(null),[d,I]=c.useState("monthly"),r=C.find(a=>a.id===h),U=C,z=a=>{I(a?"annual":"monthly")},f=(a,s)=>{if(!a||!s)return 0;const t=parseFloat(a.replace("€","")),n=parseFloat(s.replace("€",""));return Math.round((t-n)/t*100)},G=a=>{j(a),u(!0)},H=()=>{console.log("Mejorando a plan:",i.name),p(i.id),g({title:"Suscripción Actualizada",description:`Has cambiado tu plan a ${i.name}.`}),u(!1),j(null)},L=()=>{console.log("Cancelando suscripción..."),p("free"),g({title:"Suscripción Cancelada",description:"Tu suscripción ha sido cancelada. Ahora estás en el plan Gratuito.",variant:"destructive"}),b(!1)};if(!r)return e.jsx("div",{className:"container mx-auto p-4 md:p-8 bg-background dark:bg-slate-900 min-h-screen",children:e.jsx("p",{className:"text-destructive",children:"Error: No se pudo cargar la información de tu suscripción."})});const l=a=>{if(a.id==="free")return{mainPrice:"0€",period:"/mes",originalPrice:null,discountBadge:null,saving:null};if(d==="annual"){const s=a.annualPrice,t=a.annualOriginalPrice,n=f(t,s),M=(parseFloat(s.replace("€",""))/12).toFixed(2),J=(parseFloat(t.replace("€",""))-parseFloat(s.replace("€",""))).toFixed(2);return{mainPrice:s,period:"/año",originalPrice:t,discountBadge:n?`${n}% dto.`:null,saving:`Equivale a ${M}€/mes. Ahorro de ${J}€`}}else{const s=a.price,t=a.originalPrice,n=f(t,s);return{mainPrice:s,period:"/mes",originalPrice:t,discountBadge:n?`${n}% dto.`:null,saving:null}}};return e.jsxs("div",{className:"container mx-auto p-4 md:p-8 bg-background dark:bg-slate-900 min-h-screen",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-foreground dark:text-white",children:"Gestionar Suscripción"}),e.jsx("p",{className:"text-muted-foreground dark:text-gray-400",children:"Consulta los detalles de tu plan actual y explora otras opciones."})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-6",children:[e.jsx(y,{htmlFor:"billing-toggle",className:d==="monthly"?"text-muted-foreground":"text-foreground font-medium",children:"Facturación mensual"}),e.jsx(X,{id:"billing-toggle",checked:d==="annual",onCheckedChange:z}),e.jsxs(y,{htmlFor:"billing-toggle",className:d==="annual"?"text-foreground font-medium":"text-muted-foreground",children:["Facturación anual",e.jsx(N,{variant:"secondary",className:"ml-2 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100",children:"2 meses gratis"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(m,{className:`shadow-xl border-2 ${r.borderColor} ${r.bgColor} relative overflow-hidden`,children:[r.popular&&e.jsx("div",{className:"absolute top-0 -right-10 transform rotate-45 bg-yellow-400 dark:bg-yellow-500 text-center text-xs font-semibold py-1.5 px-10 text-slate-900",children:"Popular"}),e.jsxs(k,{children:[e.jsx(v,{className:`text-2xl font-bold ${r.textColor}`,children:"Tu Plan Actual"}),e.jsxs(w,{className:`${r.textColor==="text-white"||r.textColor.includes("dark:text-white")?"text-gray-300":"text-muted-foreground"}`,children:["Estás suscrito al plan ",r.name]})]}),e.jsxs(P,{className:`${r.textColor}`,children:[e.jsxs("div",{className:"mb-4 relative",children:[l(r).discountBadge&&e.jsx(N,{className:"absolute -top-3 -left-2 bg-yellow-400 text-yellow-900",children:l(r).discountBadge}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[l(r).originalPrice&&e.jsx("span",{className:"text-lg line-through opacity-70",children:l(r).originalPrice}),e.jsx("span",{className:"text-4xl font-extrabold",children:l(r).mainPrice}),e.jsx("span",{className:"opacity-80",children:l(r).period})]}),l(r).saving&&e.jsx("p",{className:"text-sm mt-1 text-green-600 dark:text-green-400",children:l(r).saving})]}),e.jsx("p",{className:`mb-6 text-sm ${r.textColor==="text-white"||r.textColor.includes("dark:text-white")?"text-gray-300":"text-muted-foreground"}`,children:r.description}),e.jsx("ul",{className:"space-y-2 mb-6",children:r.features.map((a,s)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx($,{size:16,className:`${r.popular?"text-yellow-400 dark:text-yellow-500":"text-green-500 dark:text-green-400"} mr-2 flex-shrink-0`}),e.jsx("span",{children:a})]},s))}),e.jsx("p",{className:"text-xs opacity-70 mb-2",children:"Próxima fecha de facturación: 26 de Junio, 2025 (simulado)"}),r.id!=="free"&&e.jsxs(D,{open:T,onOpenChange:b,children:[e.jsx(W,{asChild:!0,children:e.jsx(o,{variant:"destructive",className:"w-full mt-4",children:"Cancelar suscripción"})}),e.jsxs(S,{children:[e.jsxs(F,{children:[e.jsx(O,{children:"¿Seguro que quieres cancelar?"}),e.jsx(B,{children:"Al cancelar tu suscripción perderás acceso a todas las funcionalidades premium al final del período actual."})]}),e.jsxs(E,{children:[e.jsx(A,{asChild:!0,children:e.jsx(o,{variant:"outline",children:"Cancelar"})}),e.jsx(o,{variant:"destructive",onClick:L,children:"Confirmar cancelación"})]})]})]}),r.id==="free"&&e.jsx("p",{className:"text-sm text-center mt-4 p-3 bg-green-500/10 text-green-700 dark:text-green-300 dark:bg-green-500/20 rounded-md",children:"Estás en el plan Gratuito. ¡Considera mejorar para acceder a más funcionalidades!"})]})]})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(m,{className:"bg-card dark:bg-gray-800/60 border-border dark:border-gray-700/50 shadow-lg",children:[e.jsxs(k,{children:[e.jsx(v,{className:"text-foreground dark:text-white",children:"Explora Otros Planes"}),e.jsx(w,{className:"text-muted-foreground dark:text-gray-400",children:"Encuentra el plan que mejor se adapte a tus necesidades actuales."})]}),e.jsx(P,{className:"grid md:grid-cols-2 gap-6",children:U.map(a=>a.id!==h&&e.jsxs(m,{className:`flex flex-col justify-between p-6 rounded-lg border-2 hover:shadow-xl transition-shadow duration-300 ${a.borderColor} ${a.bgColor}`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-xl font-semibold mb-1 ${a.textColor}`,children:a.name}),e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:`text-3xl font-bold ${a.textColor}`,children:a.price}),e.jsx("span",{className:`text-sm ${a.textColor==="text-white"||a.textColor.includes("dark:text-white")?"text-gray-300":"text-muted-foreground"} opacity-80`,children:a.period})]}),e.jsx("p",{className:`text-xs mb-4 h-10 ${a.textColor==="text-white"||a.textColor.includes("dark:text-white")?"text-gray-300":"text-muted-foreground"}`,children:a.description}),e.jsxs("ul",{className:"space-y-1.5 mb-4 text-xs",children:[a.features.slice(0,3).map((s,t)=>e.jsxs("li",{className:`flex items-center ${a.textColor==="text-white"||a.textColor.includes("dark:text-white")?"text-gray-200":"text-foreground/90"}`,children:[e.jsx($,{size:14,className:`${a.popular?"text-yellow-400 dark:text-yellow-500":"text-green-500 dark:text-green-400"} mr-2 flex-shrink-0`}),e.jsx("span",{children:s})]},t)),a.features.length>3&&e.jsx("li",{className:`text-xs ${a.textColor==="text-white"||a.textColor.includes("dark:text-white")?"text-gray-300":"text-muted-foreground"} opacity-80`,children:"...y más"})]})]}),e.jsxs(o,{onClick:()=>G(a),className:`w-full mt-auto ${a.buttonClass} ${a.name==="Profesional"?"shadow-md shadow-green-500/20":""} ${a.popular?"shadow-md shadow-primary/20 dark:shadow-blue-500/20":""}`,children:[r.price.replace("€","")<a.price.replace("€","")||r.id==="free"?"Mejorar a ":"Cambiar a "," ",a.name]})]},a.id))})]}),e.jsxs("div",{className:"mt-8 p-6 bg-blue-500/10 dark:bg-blue-500/20 border border-blue-500/20 dark:border-blue-500/30 rounded-lg text-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary dark:text-blue-300 mb-2 flex items-center justify-center",children:[e.jsx(K,{size:20,className:"mr-2"})," ¿Buscas un plan anual con descuento?"]}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mb-3",children:"Ofrecemos descuentos significativos para suscripciones anuales. ¡Ahorra hasta 2 meses!"}),e.jsx(o,{asChild:!0,variant:"outline",className:"border-primary text-primary hover:bg-primary/10 dark:border-blue-400 dark:text-blue-300 dark:hover:bg-blue-400/20",children:e.jsx(Q,{to:"/profesionales#pricing",children:"Ver Opciones Anuales"})})]})]})]}),i&&e.jsx(D,{open:q,onOpenChange:u,children:e.jsxs(S,{className:"bg-card dark:bg-gray-800 border-border dark:border-gray-700",children:[e.jsxs(F,{children:[e.jsx(O,{className:"text-foreground dark:text-white",children:"Confirmar Cambio de Plan"}),e.jsxs(B,{className:"text-muted-foreground dark:text-gray-400",children:["Estás a punto de cambiar tu plan a ",e.jsx("span",{className:"font-semibold text-primary dark:text-blue-400",children:i.name})," por ",i.price,i.period,". Se aplicarán los cargos correspondientes. ¿Deseas continuar?"]})]}),e.jsxs(E,{className:"sm:justify-between gap-2",children:[e.jsx(A,{asChild:!0,children:e.jsx(o,{variant:"outline",className:"dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700",children:"Cancelar"})}),e.jsx(o,{onClick:H,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:"Confirmar y Cambiar Plan"})]})]})})]})};export{ee as default};
